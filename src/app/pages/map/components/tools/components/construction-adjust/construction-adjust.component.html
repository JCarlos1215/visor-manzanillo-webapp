<div class="construction-adjust-title">
  <mat-icon> settings_overscan </mat-icon>
  <span class="flex-blank-filler">
    Ajuste a construcciones
  </span>
  <button mat-icon-button (click)="callClose()">
    <mat-icon> close </mat-icon>
  </button>
</div>

<div class="construction-adjust-container">
  <div class="construction-adjust-content">
    <div class="shadow">
      <section>
        <div class="select-option">
          <select class="full-select" [(ngModel)]="optionSelected" (change)="handleSelectLayer()" name="selectOption">
            <option selected disabled value="">Selecciona tipo de ajuste</option>
            <option ngValue="align">
              Alinea lindero
            </option>
            <option ngValue="split">
              Partir construcciones
            </option>
          </select>

          <div *ngIf="isOptionSelected">
            <p>Selecciona 2 predios para realizar ajuste</p>
          </div>
        </div>
      </section>
    </div>

    <div class="shadow">
      <header>Predios ({{ prediosSelected.length }})</header>
      <section>
        <div class="data-table">
          <table mat-table [dataSource]="predios">
            <ng-container matColumnDef="clave">
              <th mat-header-cell *matHeaderCellDef>Clave</th>
              <td mat-cell *matCellDef="let row">{{ row.clave }}</td>
            </ng-container>

            <ng-container matColumnDef="subpredio">
              <th mat-header-cell *matHeaderCellDef>Subpredio</th>
              <td mat-cell *matCellDef="let row">{{ row.unidad }}</td>
            </ng-container>

            <ng-container matColumnDef="cuenta">
              <th mat-header-cell *matHeaderCellDef>Cuenta</th>
              <td mat-cell *matCellDef="let row">{{ row.cuenta }}</td>
            </ng-container>

            <ng-container matColumnDef="areaCartografica">
              <th mat-header-cell *matHeaderCellDef>Área cartográfica</th>
              <td mat-cell *matCellDef="let row">{{ row.area | number: "1.2-2" }}m<sup>2</sup></td>
            </ng-container>

            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>Acciones</th>
              <td mat-cell *matCellDef="let row" class="action-button">
                <button
                  mat-icon-button
                  color="primary"
                  matTooltip="Eliminar predio seleccionado"
                  (click)="deleteSelected(row.idPredio)"
                >
                  <mat-icon>delete_forever</mat-icon>
                </button>
              </td>
            </ng-container>

            <tr
              mat-header-row
              *matHeaderRowDef="predioColumns; sticky: true">
            </tr>
            <tr
              mat-row
              *matRowDef="let row; columns: predioColumns"
              class="row-pointer"
            ></tr>
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell" colspan="5">
                No se han seleccionado predios para ajuste
              </td>
            </tr>
          </table>
        </div>
      </section>
      <!--<div class="select-option" *ngIf="optionSelected === 'align'">
        <label for="tolerance">
          <span>Tolerancia</span>
          <input class="control" id="tolerance" type="number" [(ngModel)]="tolerance" step=".01" min="0" max="0.35"/>
        </label>
      </div>-->
      <div *ngIf="showResult" class="result-container" [ngClass]="{'correct': resultCorrect}">
        {{ resultMessage }}
      </div>
      <div class="action-section">
        <button mat-flat-button color="primary" (click)="applyAdjust()" [disabled]="prediosSelected.length !== 2">
          Aplica ajuste
        </button>
      </div>
    </div>
  </div>
</div>

<sic-backdrop [backdropMessage]="backdropMessage" [showingLoading]="showLoading"></sic-backdrop>
